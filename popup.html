<html>
<head>
<title>Popup</title>

<link rel="stylesheet" href="content.css" type="text/css" media="all"/>
<script type="text/javascript" src="jquery-1.4.2.min.js"></script>


<script type="text/javascript">


$(document).ready(
	

);

</script>
</head>
<body onload="setTimeout(init,0);" style="widht: 300px;">

<div class="section-header first">Your Queries</div>
<p>add your search words</p>

<div class="filters">
<div id="template"><span id="iconService"></span> <input
	type="text" class="tag" oninput="markDirty()"> <input
	type="text" class="avgWeek" disabled="disabled" value="0"> <input
	type="text" class="avgDay" disabled="disabled" value="0"> <span
	id="btnRemove"></span></div>
</div>
<span id="btnAdd"> add new
</div>



<div id="footer">
<button id="save-button" style="font-weight: bold" onclick=save();>Save</button>
<button onclick=init();>Cancel</button>
</div>

<script><!--
	var queriessTextbox;
	var saveButton;

	function init() {
		var port = chrome.extension.connect({name: "social-media-monitoring"});
		port.onMessage.addListener(function(msg) {
		  if (msg.update)
			  msg.update
		});
		
		var filtersObj = $("filters");
		template = xpath('//div[@id="template"]/span', document);
		inputTag = xpath('//input[@class="tag"]/input', template);
		inputAvgWeek = xpath('//input[@class="avgWeek"]/input', template);
		inputAvgDay	 = xpath('//input[@class="avgDay"]/input', template);
		

		//alert('inputTag:' + inputTag);
		
		queriessTextbox = $("custom-query");
			
		saveButton = $("save-button");

		queriessTextbox.value = localStorage.queries || "";

		/*
		  Iterate via textboxes
		*/
		$(".query").each(function(index){
			//TODO

		});

		// copy node and update
		  //item = template.cloneNode(true);
		  //timeline.appendChild(item);
		
	
		
		markClean();
	}

	// evaluate xpath
	function xpath(path, node) {
	  return document.evaluate(path, node).iterateNext();
	}
	
	function save() {
		var tagFilter = new Object();
		tagFilter.id = "#hashtag";
		tagFilter.threshold = 0;
		tagFilter.weeklyAvg = 0;
		tagFilter.hourlyAvg = 0;
				
		var tagFilters = getItem("filters");
				
		setItem("filters", tagFilters.push(tagFilter));
			
		markClean();

		chrome.extension.getBackgroundPage().init();
	}

	function markDirty() {
		saveButton.disabled = false;
	}

	function markClean() {
		saveButton.disabled = true;
	}
--></script>
</body>
</html>